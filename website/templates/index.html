{% extends "base.html" %}

{% block content %}

{% if featured_events %}
  {% include 'partials/featured_carousel.html' %}
{% endif %}

<!-- Event content -->

<!-- Category filters -->
<ul class="nav nav-underline mb-3" id="filterTabs">
  <li class="nav-item">
    <a class="nav-link active" href="#" data-filter="all">All</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#" data-filter="today">Today</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#" data-filter="weekend">This Weekend</a>
  </li>
</ul>

<div class="mb-3">
  <div id="event-grid">
    {% include "_event_cards.html" %}
  </div>
</div>

<!-- Load more events button -->

<div class="text-center">
  <button class="btn btn-primary mb-3" type="button">Load more events</button>
</div>

</div>

<!-- Bootstrap script -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- No reload -->

<script>
  document.querySelectorAll('.nav-link[data-filter]').forEach(link => {
    link.addEventListener('click', async (e) => {
      e.preventDefault();
      const filter = e.target.dataset.filter;

      // Update active tab styling
      document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
      e.target.classList.add('active');

      // Fetch updated event grid
      const res = await fetch(`/events/filter?filter=${filter}`);
      const html = await res.text();

      // Replace only the grid section
      document.getElementById('event-grid').innerHTML = html;
    });
  });
</script>

{% endblock %}